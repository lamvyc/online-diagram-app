# 项目连续性简报（2025-11-28 最终版 - 后端完成）

## 1. 项目目标

- **项目名称**：极简在线流程图工具 (V1.0)  
- **产品定位**：一个极简的、用于快速绘制和保存流程图的在线工具。  
- **目标用户**：产品经理、学生。

---

## 2. 关键技术/方案决策

- **后端框架**：Python + FastAPI  
- **数据库**：MySQL & SQLAlchemy ORM  
- **核心存储方案**：流程图内容作为完整的 JSON 对象，存储在 `diagrams` 表的 `content` 字段中。  
- **密码哈希**：Argon2（通过 `argon2-cffi` 和 `passlib` 实现）  
- **认证机制**：JWT（JSON Web Token），通过 `Authorization: Bearer <token>` 请求头传递。

---

## 3. 已完成的 API 设计与实现（Backend Complete）

### 认证 (`/auth`)
- `POST /auth/register` ✅ 已实现。用户注册。
- `POST /auth/login` ✅ 已实现。用户登录，返回 JWT。

### 用户 (`/users`)
- `GET /users/me` ✅ 已实现。获取当前登录用户信息（受保护）。

### 流程图 (`/diagrams`)
- `POST /diagrams` ✅ 已实现。为当前用户创建新流程图（受保护）。
- `GET /diagrams` ✅ 已实现。获取当前用户的所有流程图列表，支持分页（受保护）。
- `GET /diagrams/{diagram_id}` ✅ 已实现。获取单个流程图，校验所有权（受保护）。
- `PUT /diagrams/{diagram_id}` ✅ 已实现。更新单个流程图，校验所有权（受保护）。
- `DELETE /diagrams/{diagram_id}` ✅ 已实现。删除单个流程图，校验所有权（受保护）。

---

## 4. 当前开发进度

- **后端服务**：✅ 已完成。一个功能完备、安全可靠、符合 RESTful 风格的后端 API 服务已经搭建并调试完毕。  
- **环境与结构**：项目结构清晰，依赖通过 `requirements.txt` 管理，并已初始化为 Git 仓库。  
- **认证与授权**：已建立完整的用户认证与授权系统，能够保护需要登录才能访问的 API 接口。  
- **核心业务**：已完成围绕核心资源“流程图”的完整 CRUD（创建、读取、更新、删除）操作。  
- **API 文档**：`/docs` 页面功能完善，可用于测试所有已实现的 API。

---

## 5. 遇到的主要障碍及解决方案

- **bcrypt 兼容性问题**：通过更换为 Argon2 哈希算法成功解决。  
- **API 文档 UI 显示问题**：通过在 `main.py` 中自定义 OpenAPI schema，强制覆盖安全方案的定义，成功解决了 UI 显示问题。

---

## 6. 下一步方向（决策点）

### 方向一：前端集成（推荐）
- 使用 Vue/React 框架，调用现有 API，开发一个功能性的前端单页应用（SPA），将项目“做活”。

### 方向二：后端深化
为现有后端服务添加更高级的功能，例如：
- 公开分享功能：`/share/{uuid}`  
- 版本历史记录：`/diagrams/{id}/versions`  
- 后端图片导出